{"time":"0010","tplId":"QUICKPAY@deduct-pre-confirm-flex","publishVersion":"150924","tag":"QUICKPAY","name":"deduct-pre-confirm-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","children":[{"text":"var rpc=amc.rpcData;var getTag=amc.fn.getById;var create=amc.fn.create;var show=amc.fn.show;var hide=amc.fn.hide;var navTitle=rpc.navTitle||\"\";var protocols=rpc.protocols;var pwdTip=rpc.pwdTip||\"\";var useSpwd=rpc.spasswordPay;var nextAction=rpc.nextAction||\"\";var doingText=rpc.doingText||\"\";var maxLength=100;var btnHeight=amc.isPlus?96:73;var protocolHeight=0;var showInfoBox=false;var rpcShift=rpc.shift;var deductBtnTxt=rpc.btnName||\"{{confirm_btn}}\";var payBtnTxt=(rpcShift&&rpcShift.buttonText)||\"{{confirm_btn}}\";var payNextAction=rpcShift&&rpcShift.nextAction;function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var c=amc.fn.navBack(true,navTitle,null,null,onBack,null);getTag(\"body\").insertBefore(c,getTag(\"mainBody\"));if(rpc.orderTitle){getTag(\"orderTitle\").innerText=rpc.orderTitle;var b=rpc.orderDetail;if(b&&b.length>maxLength){b=b.substr(0,maxLength)+\"...\"}if(b){getTag(\"orderDetail\").innerText=b}else{hide(\"orderDetail\")}}else{hide(\"orderInfoBox\")}if(rpc.npwdPayTitle){getTag(\"npwdPayTitle\").innerText=rpc.npwdPayTitle;getTag(\"npwdPayDetail\").innerText=rpc.npwdPayDetail||\"\";getTag(\"npwdPayTitle\").style.maxWidth=amc.isPlus?300:240;showInfoBox=true}else{hide(\"npwdPayInfo\")}showCreditProtocol();showSwitchBtn();if(rpc.protocolName&&protocols&&protocols.length){amc.fn.show(\"protocolBox\");protocolHeight=amc.isPlus?62:47;getTag(\"protocolName\").innerText=rpc.protocolName}var d=rpc.items&&rpc.items.length;for(var a=0;a<d;a++){createItem(rpc.items[a]);if(a<d-1){create(\"div\",\"amc-1px-line amc-margin-l margin-t-minus\",getTag(\"items\"))}}getTag(\"scrollBox\").style.maxHeight=amc.specs.bodyHeight-btnHeight-protocolHeight;if(amc.isPlus){getTag(\"btnContainer\").style.height=56;getTag(\"btnContainer\").style.maxHeight=56}if(rpc.limitInfo){show(\"limitInfoBox\");getTag(\"limitInfo\").innerText=rpc.limitInfo}if(rpc.channelInfo){show(\"channelInfoBox\");getTag(\"channelInfo\").innerText=rpc.channelInfo}if(!showInfoBox){hide(\"infoBox\")}getTag(\"infoImg\").src=amc.path+\"alipay_msp_info_gray\";if(amc.isPlus){getTag(\"infoImg\").className=\"info-img-plus\"}getTag(\"titleLogo\").src=amc.path+\"alipay_msp_key_info\";if(amc.isAndroid){getTag(\"loading\").src=amc.path+\"alipay_msp_indicator_white_loading\"}getTag(\"dlgTitle\").innerText=rpc.dlgTitle||\"{{deduct_dlg_title}}\";getTag(\"dlgInform\").innerText=rpc.dlgTitle||\"{{deduct_dlg_inform}}\";getTag(\"dlgOrder\").innerText=rpc.dlgTitle||\"{{deduct_dlg_order}}\";getTag(\"dlgTitle\").style.maxWidth=window.innerWidth-130}function showProtocol(){amc.fn.showProtocolList(protocols)}function showSwitchBtn(){var a=\"on\";if(rpcShift&&rpcShift.nextAction){a=(rpcShift.value===\"Y\")?\"on\":\"off\";show(\"switchBtn\")}getTag(\"switchBtn\").value=a;if(getTag(\"switchBtn\").value===a){onSwitchChange(a)}}function gotoPwdPage(){var a={};if(rpcShift&&(getTag(\"switchBtn\").value===\"off\")){a.action={};a.action={name:payNextAction,loadtxt:\"\"};amc.fn.shouldShowBtnIndicator({pageloading:\"1\"},\"btnConfirm\",\"loading\");document.asyncSubmit(a,function(c){amc.fn.shouldShowBtnIndicator(c,\"btnConfirm\",\"loading\")})}else{if(rpc.needAddNewCard){a.action={};a.action={name:nextAction,loadtxt:\"\"};amc.fn.shouldShowBtnIndicator({pageloading:\"1\"},\"btnConfirm\",\"loading\");document.asyncSubmit(a,function(c){amc.fn.shouldShowBtnIndicator(c,\"btnConfirm\",\"loading\")})}else{a.action={name:\"loc:bnvb\"};a.param={};var b=rpc.bypass||{};a.param[\"data\"]=amc.fn.isObject(b.pwd)?b.pwd:{};a.param[\"data\"][\"spasswordPay\"]=useSpwd;a.param[\"data\"][\"nextAction\"]=nextAction;a.param[\"data\"][\"doingText\"]=doingText;a.param[\"data\"][\"pwdTip\"]=pwdTip;a.param[\"data\"][\"payOrder\"]=rpc.payOrder;a.param[\"data\"][\"logon_id\"]=rpc.logon_id;a.param[\"tplid\"]=\"QUICKPAY@open-pwd-check-flex\";a.param[\"tpl\"]=rpc.tpl;document.submit(a)}}}function createItem(e){if(!e.title){return}var b=create(\"div\",\"amc-pd amc-bg-white\",getTag(\"items\"));var g=create(\"label\",\"self-start amc-font-xl amc-ellipsis left-width\",b);g.innerText=e.title;var d=create(\"div\",\"self-start amc-v-box amc-margin-l-xs amc-flex-1\",b);if(e.desc){var f=create(\"label\",\"amc-text-slight-color amc-font-m amc-text-right amc-ellipsis\",d);f.innerText=e.desc}if(e.actionName){b.className+=\"  amc-press-box\";var c=create(\"div\",\"img-box self-center amc-align-center amc-justify-end\",b);var a=create(\"img\",\"\",c);a.src=amc.res.arrowRight;b.onclick=function(){a.src=amc.res.indicator;var h={action:{name:e.actionName,loadtxt:\"\"}};document.asyncSubmit(h,function(i){if(i.pageloading===\"1\"){a.src=amc.res.indicator}else{if(i.pageloading===\"0\"){a.src=amc.res.arrowRight}}})}}}function onBack(){if(rpc.backAct){var a={action:{name:rpc.backAct}};document.submit(a)}else{amc.fn.exitConfirm()}}function showCreditProtocol(){var a=rpc.creditProtocol;if(!a||!a.detail||!a.title||!a.url){return}getTag(\"creditTitle\").innerText=a.title;getTag(\"creditDetail\").innerText=a.detail;show(\"creditInfo\");showInfoBox=true}function openCreditProtocol(){var b=\"\";if(rpc.creditProtocol[\"urlTitle\"]){b=\",'\"+rpc.creditProtocol[\"urlTitle\"]+\"'\"}var a=\"loc:openweb('\"+rpc.creditProtocol[\"url\"]+\"'\"+b+\")\";document.submit({action:{name:a}})}function onSwitchChange(a){if(a===\"on\"){getTag(\"btnLabel\").innerText=deductBtnTxt;if(rpc.orderDetail){show(\"orderDetail\")}}else{getTag(\"btnLabel\").innerText=payBtnTxt;hide(\"orderDetail\")}}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".self-start {\n    align-self: flex-start;\n}\n.margin-t-minus {\n    margin-top: -1px;\n}\n.left-width {\n    width: 100px;\n}\n.self-center {\n    align-self: center;\n}\n.img-box {\n    width:24px;\n}\n.light-text-color{\n    color: #888;\n}\n.cycle {\n    width: 8px;\n    height: 8px;\n    border-radius: 4px;\n    background-color: #ccc;\n    margin-right: 7px;\n    margin-top: 5px;\n}\n.info-img{\n    height: 13px;\n    width: 13px;\n}\n.info-img-plus{\n    height: 16px;\n    width: 16px;\n}\n.title-logo {\n    height: 25px;\n    width: 25px;\n}\n.margin-zero {\n    margin: 0;\n}\n.margin-t-l {\n    margin-top: 20px;\n}\n.margin-b-l {\n    margin-bottom: 20px;\n}\n.margin-t-s {\n    margin-top: 5px;\n}\n.pd-tb {\n    padding-top: 10px;\n    padding-bottom: 10px;\n}\n\n.pd-tb-s {\n    padding-top: 5px;\n    padding-bottom: 5px;\n}\n\n.pd-b {\n    padding-bottom: 10px;\n}\n.switch-height {\n    height: 41px;\n}\n.switch-margin {\n    margin-left: 10px;\n}\n.detail-margin {\n    margin-bottom: 5px;\n}\n.agree-label {\n    max-width: 130px;\n}","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"mainBody","tag":"div","children":[{"id":"scrollBox","tag":"div","children":[{},{"id":"orderInfoBox","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"id":"orderTitle","tag":"label","css":"amc-font-xl amc-flex-1 amc-ellipsis amc-margin-lr switch-height"},{},{},{},{"id":"switchBtn","tag":"switch","value":"on","css":"switch-margin amc-hidden","onchange":"onSwitchChange"}],"css":"amc-pd-r"},{"id":"orderDetail","tag":"label","css":"amc-flex-1 amc-ellipsis-3-line light-text-color amc-font-m amc-margin-lr detail-margin"}],"css":"amc-v-box pd-tb-s amc-bg-white"},{"tag":"div","css":"amc-1px-line"}],"css":"amc-v-box amc-margin-t"},{"tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"id":"items","tag":"div","css":"amc-v-box"},{"tag":"div","css":"amc-1px-line"}],"css":"amc-v-box margin-t-l"},{},{"id":"infoBox","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"id":"npwdPayInfo","tag":"div","children":[{"tag":"div","children":[{"id":"npwdPayTitle","tag":"label","onclick":"getTag('dlg').showModal();","css":"amc-font-xs amc-ellipsis amc-theme-color amc-margin-r-xs"},{"id":"infoImg","tag":"img","onclick":"getTag('dlg').showModal();","css":"info-img"}],"css":"amc-align-center"},{"id":"npwdPayDetail","tag":"label","css":"amc-flex-1 light-text-color amc-font-xs margin-t-s"}],"css":"amc-v-box amc-pd-lr pd-tb amc-bg-white"},{},{"id":"creditInfo","tag":"div","children":[{"id":"creditTitle","tag":"label","onclick":"openCreditProtocol();","css":"amc-font-xs amc-ellipsis amc-theme-color amc-margin-r-xs"},{"id":"creditDetail","tag":"label","css":"amc-flex-1 light-text-color amc-font-xs margin-t-s"}],"css":"amc-v-box amc-pd-lr pd-b amc-bg-white amc-hidden"},{"tag":"div","css":"amc-1px-line"}],"css":"amc-v-box margin-t-l"}],"css":"amc-scroll amc-pd-b"},{},{"id":"protocolBox","tag":"div","children":[{"id":"agree","tag":"label","children":[{"text":"{{agree}}","tag":"text"}],"css":"amc-font-m amc-margin-r-xs agree-label amc-ellipsis-2-line"},{"id":"protocolName","tag":"label","onclick":"showProtocol()","css":"amc-font-m amc-theme-color amc-flex-1"}],"css":"amc-margin-t amc-pd-lr preconfirm-protocol-height amc-hidden"},{},{"id":"btnContainer","tag":"div","children":[{"id":"btnConfirm","tag":"div","children":[{"id":"btnLabel","tag":"label","children":[{"text":"{{confirm_btn}}","tag":"text"}],"css":"amc-text-center amc-pay-text amc-font-super-l amc-flex-1 amc-ellipsis"}],"onclick":"gotoPwdPage();","css":"amc-primary-btn-size amc-btn-primary amc-align-center amc-justify-center amc-pd-lr"},{"id":"loading","tag":"img","src":"indicatior","css":"amc-loading-img amc-text-white-clolor amc-hidden"}],"css":"amc-btn-primary amc-margin amc-justify-center amc-align-center"}],"css":"amc-v-box"},{},{"id":"dlg","tag":"dialog","children":[{"tag":"div","children":[{"id":"titleLogo","tag":"img","css":"title-logo amc-margin-r-xs"},{"id":"dlgTitle","tag":"label","css":"amc-dlg-title margin-zero amc-ellipsis"}],"css":"amc-align-center amc-justify-center amc-pd-lr amc-pd-t margin-b-l"},{"tag":"div","children":[{"id":"limitInfoBox","tag":"div","children":[{"tag":"div","css":"cycle"},{"id":"limitInfo","tag":"label","css":"amc-font-s amc-flex-1 amc-ellipsis-3-line"}],"css":"amc-margin-b-s amc-hidden"},{"tag":"div","children":[{"tag":"div","css":"cycle"},{"id":"dlgInform","tag":"label","css":"amc-font-s amc-flex-1 amc-ellipsis-3-line"}],"css":"amc-margin-b-s"},{"id":"channelInfoBox","tag":"div","children":[{"tag":"div","css":"cycle"},{"id":"channelInfo","tag":"label","css":"amc-font-s amc-flex-1 amc-ellipsis-3-line"}],"css":"amc-margin-b-s amc-hidden"},{"tag":"div","children":[{"tag":"div","css":"cycle amc-margin-r-xs"},{"id":"dlgOrder","tag":"label","css":"amc-font-s amc-flex-1 amc-ellipsis-3-line"}]}],"css":"amc-v-box amc-dlg-width amc-pd-lr amc-pd-b"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{i_know_it}}","tag":"text"}],"css":"amc-text-center amc-font-super amc-text-white-clolor amc-flex-1 amc-text-center amc-ellipsis"}],"onclick":"getTag('dlg').close();","css":"amc-btn-primary amc-flex-center"}],"css":"amc-flex-center amc-pd amc-dlg-width"}],"css":"amc-dlg-box amc-v-box"}],"onkeydown":"onKeyDown();","css":"amc-body"}]},"format":"JSON","tplVersion":"5.0.8"}